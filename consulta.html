<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Consulta CPF</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 40px auto; padding: 0 20px; }
    input, button { width: 100%; padding: 10px; margin-bottom: 10px; font-size: 16px; }
    pre { background: #eee; padding: 10px; border-radius: 5px; white-space: pre-wrap; }
    button#verResultado { display: none; margin-top: 15px; }
    .erro { color: red; font-weight: bold; }
  </style>
</head>
<body>

<h2>Consulta CPF</h2>
<input id="cpf" type="text" placeholder="Digite o CPF (somente números)" maxlength="11" />
<button onclick="consultar()">Consultar</button>

<pre id="jsonResposta"></pre>
<button id="verResultado" onclick="window.location.href='resultado.html'">Ver Resultado</button>

<script>
  function consultar() {
    const cpfInput = document.getElementById('cpf');
    const cpf = cpfInput.value.trim();
    const jsonResp = document.getElementById('jsonResposta');
    const btnResultado = document.getElementById('verResultado');

    if (!/^\d{11}$/.test(cpf)) {
      jsonResp.textContent = "CPF inválido! Digite 11 números.";
      btnResultado.style.display = 'none';
      return;
    }

    fetch(`https://patronhost.online/apis/cpf.php?cpf=${cpf}`)
      .then(response => response.json())
      .then(data => {
        if (data.status && data.dados) {
          localStorage.setItem('dadosConsulta', JSON.stringify(data.dados));
          jsonResp.textContent = JSON.stringify(data, null, 2);
          btnResultado.style.display = 'block';
        } else {
          jsonResp.textContent = 'Erro na consulta: ' + (data.mensagem || 'Sem dados.');
          btnResultado.style.display = 'none';
        }
      })
      .catch(err => {
        jsonResp.textContent = 'Erro na requisição: ' + err.message;
        btnResultado.style.display = 'none';
      });
  }
</script>

</body>
</html>
